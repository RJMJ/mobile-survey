template(name="survey")
  if fetched
    .survey-admin
      .header-secondary.clearfix
        .container-fluid-padded
          .navbar-header.navbar-header-secondary
            +buttonBack path='surveys'
            h2=title
            .header--actions
              unless surveyIsActive
                button.btn.btn-default.btn-sm.pull-right(
                  data-toggle="modal"
                  data-target="#edit-survey-modal"
                  data-id=survey.id)
                  | Edit

          nav
            ul.nav.navbar-nav.navbar-right.navbar-secondary
              li(class="{{isActiveRoute 'survey_details'}}")
                a.survey-admin--view-link(href="{{pathFor 'survey_details' id=survey.id}}" data-page='details') Details
              li(class="{{isActiveRoute regex='forms|forms_new|form_details|form_edit'}}")
                a.survey-admin--view-link(href="{{pathFor 'forms' id=survey.id}}" data-page='forms') Forms
              li(class="{{isActiveRoute 'survey_users'}}")
                a.survey-admin--view-link(href="{{pathFor 'survey_users' id=survey.id}}" data-page='users') Users
              if surveyIsActive
                li(class="{{isActiveRoute 'survey_results'}}")
                  a.survey-admin--view-link(href="{{pathFor 'survey_results' id=survey.id}}" data-page='results') Results

      if isActiveRoute 'survey_details'
        +survey_details(
          survey=survey
          surveyDetails=surveyDetails
          surveyState=surveyState)

      else if isActiveRoute 'forms'
        +forms survey=survey surveyState=surveyState

      else if isActiveRoute regex='form_edit|form_new'
        +form_edit data

      else if isActiveRoute 'form_details'
        +form_details data

      else if isActiveRoute 'question_details'
        +question_details data

      else if isActiveRoute 'survey_users'
        +survey_users survey=survey surveyState=surveyState

      else if isActiveRoute 'survey_results'
        +survey_results survey=survey surveyState=surveyState

      else if isActiveRoute 'survey_user_edit'
        +survey_user_edit survey=survey surveyState=surveyState

    +edit_survey_modal(
      survey=survey
      surveyDetails=surveyDetails
      surveyState=surveyState)
  else
    +loading
